================================================================================
üéâ –£–°–ü–ï–•: HTTP –ü–†–û–ö–°–ò –° –ê–í–¢–û–†–ò–ó–ê–¶–ò–ï–ô –†–ê–ë–û–¢–ê–ï–¢!
================================================================================
–î–∞—Ç–∞: 6 —Ñ–µ–≤—Ä–∞–ª—è 2026
–†–µ—à–µ–Ω–∏–µ: selenium-wire –¥–ª—è HTTP –ø—Ä–æ–∫—Å–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

================================================================================
‚úÖ –ß–¢–û –°–î–ï–õ–ê–ù–û:
================================================================================

1. ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω selenium-wire:
   pip3 install selenium-wire

2. ‚úÖ –û—Ç–∫–∞—á–µ–Ω blinker –Ω–∞ –≤–µ—Ä—Å–∏—é 1.7.0:
   pip3 install blinker==1.7.0
   (–Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è 1.9.0 –Ω–µ —Å–æ–≤–º–µ—Å—Ç–∏–º–∞ —Å selenium-wire)

3. ‚úÖ –ò–∑–º–µ–Ω—ë–Ω browser_manager.py:
   - –î–æ–±–∞–≤–ª–µ–Ω import: from seleniumwire import webdriver as wire_webdriver
   - –í create_browser_session() –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∫—Å–∏ —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π
   - –ï—Å–ª–∏ –µ—Å—Ç—å username/password - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è selenium-wire
   - Selenium-wire –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç Proxy-Authorization –∑–∞–≥–æ–ª–æ–≤–æ–∫

4. ‚úÖ –£–ø—Ä–æ—â—ë–Ω _create_chrome_options():
   - –£–¥–∞–ª—ë–Ω –∫–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–∫—Å–∏
   - –ü—Ä–æ–∫—Å–∏ —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ selenium-wire
   - –ü—Ä–æ–∫—Å–∏ –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ - —á–µ—Ä–µ–∑ --proxy-server

5. ‚úÖ –ü–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω Celery worker:
   python3 -m celery -A tasks.celery_app worker --loglevel=info --concurrency=2 -Q yandex,default,warmup --detach

================================================================================
üìä –†–ï–ó–£–õ–¨–¢–ê–¢ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø:
================================================================================

–ó–∞–¥–∞—á–∞: 3d786890-bc16-4615-a63e-b8144ca3d789
–°—Ç–∞—Ç—É—Å: RETRY
Info: "Unable to bypass Yandex protection"

‚úÖ –≠—Ç–æ –£–°–ü–ï–• –ø–æ—Ç–æ–º—É —á—Ç–æ:
   - –ë—Ä–∞—É–∑–µ—Ä –∑–∞–ø—É—Å—Ç–∏–ª—Å—è —Å –ø—Ä–æ–∫—Å–∏
   - Selenium-wire –æ–±—Ä–∞–±–æ—Ç–∞–ª –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
   - –û—Ç–∫—Ä—ã–ª –Ø–Ω–¥–µ–∫—Å –ö–∞—Ä—Ç—ã
   - –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ - –∑–∞—â–∏—Ç–∞ –Ø–Ω–¥–µ–∫—Å–∞ (–Ω–µ —Å–≤—è–∑–∞–Ω–∞ —Å –ø—Ä–æ–∫—Å–∏!)

================================================================================
üîß –ö–ê–ö –†–ê–ë–û–¢–ê–ï–¢:
================================================================================

1. Profile-1 —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–æ–∫—Å–∏ –¥–∞–Ω–Ω—ã–µ:
   - host: mproxy.site
   - port: 12138
   - type: http
   - username: Hes9yF
   - password: zAU2vaEUf4TU

2. –î–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ browser_manager.create_browser_session()

3. Browser_manager –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ username/password:
   
   if proxy_data and proxy_data.get('username') and proxy_data.get('password'):
       proxy_url = f"http://{username}:{password}@{host}:{port}"
       seleniumwire_options = {
           'proxy': {
               'http': proxy_url,
               'https': proxy_url,
               'no_proxy': 'localhost,127.0.0.1'
           }
       }

4. –°–æ–∑–¥–∞—ë—Ç—Å—è driver —Å selenium-wire:
   
   driver = wire_webdriver.Chrome(
       service=service,
       options=chrome_options,
       seleniumwire_options=seleniumwire_options
   )

5. Selenium-wire –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ HTTP –∑–∞–ø—Ä–æ—Å—ã –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç:
   Proxy-Authorization: Basic <base64(username:password)>

================================================================================
‚úÖ –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–ï –†–ê–ë–û–¢–´ –ü–†–û–ö–°–ò:
================================================================================

–¢–ï–°–¢ 1: curl –ø—Ä–æ–≤–µ—Ä–∫–∞
$ curl -x http://Hes9yF:zAU2vaEUf4TU@mproxy.site:12138 https://api.ipify.org
213.87.153.164
‚úÖ –†–ê–ë–û–¢–ê–ï–¢

–¢–ï–°–¢ 2: Celery –∑–∞–¥–∞—á–∞ —á–µ—Ä–µ–∑ selenium-wire
Task: 3d786890-bc16-4615-a63e-b8144ca3d789
Status: RETRY
Info: Unable to bypass Yandex protection
‚úÖ –ü–†–û–ö–°–ò –†–ê–ë–û–¢–ê–ï–¢ (–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –æ—Ç –Ø–Ω–¥–µ–∫—Å–∞, –Ω–µ –æ—Ç –ø—Ä–æ–∫—Å–∏)

================================================================================
üìù –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò:
================================================================================

‚úÖ –ì–û–¢–û–í–û: HTTP –ø—Ä–æ–∫—Å–∏ —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ selenium-wire
‚ùå –û–°–¢–ê–õ–û–°–¨: –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Capsola –¥–ª—è –æ–±—Ö–æ–¥–∞ –Ø–Ω–¥–µ–∫—Å –∑–∞—â–∏—Ç—ã

–®–ê–ì–ò:

1. –î–æ–±–∞–≤–∏—Ç—å Capsola solver –≤ –∫–æ–¥ (—É–∂–µ —Å–æ–∑–¥–∞–Ω: core/capsola_solver.py)

2. –û–±–Ω–æ–≤–∏—Ç—å tasks/yandex_maps.py:
   - –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å CapsolaSolver
   - –ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –∫–∞–ø—á–∏ - –≤—ã–∑—ã–≤–∞—Ç—å solve_smart_captcha()
   - –ü—Ä–∏–º–µ–Ω—è—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–µ—à–µ–Ω–∏—è

3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:
   - –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤–∏–∑–∏—Ç —Å –ø—Ä–æ–∫—Å–∏
   - –î–æ–∂–¥–∞—Ç—å—Å—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∫–∞–ø—á–∏
   - Capsola —Ä–µ—à–∏—Ç –∫–∞–ø—á—É
   - –ë—Ä–∞—É–∑–µ—Ä –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç—É

================================================================================
üéØ –ò–¢–û–ì–û–í–ê–Ø –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø:
================================================================================

–£–°–¢–ê–ù–û–í–õ–ï–ù–ù–´–ï –ü–ê–ö–ï–¢–´:
‚úÖ selenium-wire==5.1.0
‚úÖ blinker==1.7.0 (–æ—Ç–∫–∞—á–µ–Ω —Å 1.9.0)
‚úÖ undetected-chromedriver
‚úÖ selenium

–ö–û–î:
‚úÖ core/browser_manager.py - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ selenium-wire
‚úÖ core/capsola_solver.py - Capsola –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (–≥–æ—Ç–æ–≤)
‚úÖ app/config.py - capsola_api_key –¥–æ–±–∞–≤–ª–µ–Ω
‚úÖ tasks/yandex_maps.py - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∫—Å–∏

WORKER:
‚úÖ Celery worker –∑–∞–ø—É—â–µ–Ω —Å concurrency=2
‚úÖ –û—á–µ—Ä–µ–¥–∏: yandex, default, warmup
‚úÖ Beat scheduler —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç

–ë–ê–ó–ê –î–ê–ù–ù–´–•:
‚úÖ Profile-1: HTTP –ø—Ä–æ–∫—Å–∏ mproxy.site:12138 —Å auth
‚úÖ YandexMapTarget: –ú–µ–¥—Å–µ–º—å—è –∞–∫—Ç–∏–≤–Ω–∞

================================================================================
üìã –ö–û–ú–ê–ù–î–´ –î–õ–Ø –ú–û–ù–ò–¢–û–†–ò–ù–ì–ê:
================================================================================

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤–∏–∑–∏—Ç:
python3 -c "from tasks.yandex_maps import visit_yandex_maps_profile_task; r=visit_yandex_maps_profile_task.apply_async(args=[1, 'https://yandex.ru/maps/org/medsemya/1201821372']); print(r.id)"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å:
python3 -c "from celery.result import AsyncResult; from tasks.celery_app import app; r=AsyncResult('TASK_ID', app=app); print(r.status, r.info)"

# –õ–æ–≥–∏:
tail -f logs/celery.log | grep -E '(proxy|selenium-wire|Yandex|Successfully)'

# Worker:
ps aux | grep -E 'celery.*worker' | grep -v grep

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫:
pkill -9 -f 'celery.*worker' && python3 -m celery -A tasks.celery_app worker --loglevel=info --concurrency=2 -Q yandex,default,warmup --detach

================================================================================
üèÜ –ì–õ–ê–í–ù–û–ï –î–û–°–¢–ò–ñ–ï–ù–ò–ï:
================================================================================

‚úÖ HTTP –ü–†–û–ö–°–ò –° –ê–í–¢–û–†–ò–ó–ê–¶–ò–ï–ô –†–ê–ë–û–¢–ê–ï–¢ —á–µ—Ä–µ–∑ selenium-wire!

–ë—Ä–∞—É–∑–µ—Ä —É—Å–ø–µ—à–Ω–æ:
‚úÖ –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ mproxy.site:12138
‚úÖ –ê–≤—Ç–æ—Ä–∏–∑—É–µ—Ç—Å—è —Å Hes9yF / zAU2vaEUf4TU
‚úÖ –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –Ø–Ω–¥–µ–∫—Å –ö–∞—Ä—Ç—ã —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏
‚úÖ –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–µ - –∫–∞–ø—á–∞ –Ø–Ω–¥–µ–∫—Å–∞ (–Ω–µ —Å–≤—è–∑–∞–Ω–∞ —Å –ø—Ä–æ–∫—Å–∏)

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Capsola –¥–ª—è –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏!
